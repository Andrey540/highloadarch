# Отчёт по домашнему заданию №8

## Описание

Систему диалогов в отдельный микросервис не выносил так как изначально это был отдельный микросервис.
Клиент (frontend) общается с микросервисами через REST, а микросервисы друг с другом через GRPC. При этом микросервисы ничего про друг друга не знают.
В папке pkg/common/api находятся схемы микросервисов. У микросервисов описана схема в виде proto-файлов.
Из этих proto-файлов при сборке автоматически генерится swagger схемы.
Микросервисы не доступны из вне внутринней сети. Однако микросервис socialnetwork может проксиовать к ним запросы предварительно проверяя аутентификацию.
После проврки аутентификации микросервис socialnetwork понимает что это за пользователь и далее в загооловке передаёт его идентификатор в микросервисы.
Далее по этому заголовку может быть проведена авторизация.
Микросервис socialnetwork является ApiGateway и BFF. Он ходит в микросервисы через GRPC, аггрегирует данные
и отдаёт их на frontend.
Каждый микросервис логирует запросы, которые он обрабатывает в потоки stdout и stderr.
При этом для трассировки используется идентификатор запроса. Идентификатор запроса создаёт socialnetwork и передаёт его во все микросервисы.
Таким образом можно отследить действия запроса во всех микросервисах.
Клиенты могут обновлять приложение не быстро, для этого в api предусмотрено версионирование.
Например, запрос /conversation/api/v1/message/add использует версию api v1. Нри обратно несовместимом изменении api
версия может быть инкрементирована и какое-то время микросервис может поддерживать несколько версий api.

Для корректно работы приложения нужно удалить старую базу микросервиса post. Для этого нужно выполнить следующие команды.
```bash
docker rm mysql-post
docker volume rm highloadarch_socialnetwork-db-post-data
```

После чего поднить контейнеры.
```bash
docker-compose up
```

И запустить репликацию.
```bash
./start_replication.sh
```